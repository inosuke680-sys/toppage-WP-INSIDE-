# ウマ店トップページ WordPressプラグイン

グルメポータルサイト「ウマ店」のトップページコンテンツを表示するWordPressプラグインです。

## バージョン 1.1.0 の変更点（スマホ対応修正版）

### 修正内容

スマホからアクセスした際に都道府県カードが表示されない問題を修正しました。

#### 主な修正点：

1. **CSS詳細度の向上**
   - `.meshimap-area-content`の表示制御に`!important`を追加
   - WordPressテーマのスタイルとの競合を防止

2. **スマホ用レスポンシブデザインの最適化**
   - 480px以下の画面で都道府県カードを1列表示に変更
   - カードの高さを200pxに固定して確実に表示
   - `grid-template-columns: 1fr !important`で強制的に1列表示を保証

3. **JavaScript の改善**
   - WordPress環境での動作を保証する初期化処理を追加
   - ページ読み込み時に北海道エリアを確実に表示
   - `display: block/none`をインラインスタイルでも制御して二重保証
   - コンソールログを追加してデバッグを容易に

4. **初期表示の処理強化**
   - DOMContentLoaded、window.load の両方で初期化を実行
   - 遅延読み込みにも対応（100ms後に再初期化）

### 技術的な詳細

#### 修正前の問題点：
- WordPressテーマのCSSが`.meshimap-area-content`を上書き
- スマホでのグリッドレイアウトが崩れる
- JavaScriptの初期化タイミングの問題
- activeクラスが正しく適用されない場合がある

#### 修正後の改善：
- CSS詳細度を上げて確実に制御
- スマホ専用のメディアクエリを強化
- JavaScriptで二重チェック機能を実装
- インラインスタイルとクラスの両方で表示制御

## インストール方法

### 方法1: WordPressダッシュボードから

1. このプラグインをZIPファイルとしてダウンロード
2. WordPressダッシュボードの「プラグイン」→「新規追加」→「プラグインのアップロード」
3. ZIPファイルを選択してアップロード
4. 「プラグインを有効化」をクリック

### 方法2: FTP/SFTPでアップロード

1. このプラグインフォルダを `/wp-content/plugins/` ディレクトリにアップロード
2. WordPressダッシュボードの「プラグイン」メニューからプラグインを有効化

## 使用方法

### ショートコードを使用

任意の固定ページや投稿に以下のショートコードを記述してください：

```
[umaten_toppage]
```

### 推奨設定

- **テーマ**: Swellテーマで最適化されていますが、他のテーマでも動作します
- **ページテンプレート**: フルワイドテンプレートを推奨
- **サイドバー**: 非表示にすることを推奨

## ファイル構成

```
umaten-toppage/
├── umaten-toppage-plugin.php  # メインプラグインファイル
├── umaten-toppage.html        # トップページのHTMLコンテンツ
└── README.md                  # このファイル
```

## 動作要件

- WordPress 5.0 以上
- PHP 7.0 以上
- モダンブラウザ（Chrome, Firefox, Safari, Edge最新版）
- モバイルブラウザ対応

## レスポンシブ対応

このプラグインは以下の画面サイズに対応しています：

- **デスクトップ**: 1400px以上（最大幅）
- **タブレット**: 768px以下
- **スマートフォン**: 640px以下
- **小型スマートフォン**: 480px以下

## トラブルシューティング

### スマホで都道府県が表示されない場合

1. **ブラウザのキャッシュをクリア**してください
2. **WordPressテーマのCSS競合**を確認してください
3. ブラウザの開発者ツールでコンソールログを確認してください
4. CSSの`!important`が他のスタイルシートで上書きされていないか確認してください

### JavaScriptが動作しない場合

1. ブラウザのJavaScriptが有効になっているか確認
2. 他のプラグインとの競合を確認（一時的に他のプラグインを無効化してテスト）
3. ブラウザのコンソールにエラーメッセージが表示されていないか確認

### デバッグモード

ブラウザの開発者ツール（F12）のコンソールタブで、以下のログメッセージを確認できます：

- `エリアタブを初期化中...`
- `タブ数: X コンテンツ数: Y`
- `北海道エリアを表示しました`
- `タブがクリックされました: XXXX`
- `エリアを表示: XXXX`

これらのメッセージが表示されない場合は、JavaScriptが正しく読み込まれていない可能性があります。

## サポート

問題が発生した場合は、以下の情報を含めてお問い合わせください：

1. WordPressのバージョン
2. 使用しているテーマ名とバージョン
3. 他にインストールしているプラグインのリスト
4. ブラウザの種類とバージョン
5. 画面サイズ（スマホの場合は機種名）
6. ブラウザコンソールのエラーメッセージ（あれば）

## ライセンス

GPL v2 or later

## 更新履歴

### 1.1.0 (2024-11-14)
- スマホで都道府県が表示されない問題を修正
- CSS詳細度を向上させてテーマとの競合を防止
- JavaScript初期化処理を改善
- レスポンシブデザインを最適化
- デバッグ用のコンソールログを追加

### 1.0.0
- 初回リリース
- 基本的なトップページ機能を実装
